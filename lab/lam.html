<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>ArcGIS JavaScript Tutorials: Create a Starter App</title>
  <style>
    html,
    body,
    #viewDiv {
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;
    }
  </style>

  <link rel="stylesheet" href="https://js.arcgis.com/4.26/esri/themes/light/main.css">
  <script src="https://js.arcgis.com/4.26/"></script>

  <script>
    var point_template_tree = {
      title: "{Name}",
      content: "Cây này ở <b>{Location}</b>."
    };
    var point_template_light = {
      title: "{Name}",
      content: "Bóng đèn này ở <b>{Location}</b>."
    };
    var point_template_chair = {
      title: "{Name}",
      content: "Cái ghế này ở <b>{Location}</b>."
    };
    var point_template_area = {
      title: "{Name}",
      content: "Khu vực này ở <b>{Location}</b>."
    };
    var point_template_university = {
      title: "{Name}",
      content: "Trường ở <b>{Location}</b>."
    };
    var jsondata = {
      "type": "FeatureCollection",
      "features": [
        {
          "type": "Feature",
          "properties": {
            "name": "Đường ranh giới",
            "description": "Đường ranh giới khu vực SVĐ Quân khu 7"
          },
          "geometry": {
            "coordinates": [
              [106.666827, 10.802622],
              [106.667009, 10.802566],
              [106.667086, 10.802669],
              [106.667142, 10.802720],
              [106.667198, 10.802763],
              [106.667253, 10.802790],
              [106.667313, 10.802817],
              [106.667382, 10.802832],
              [106.667455, 10.802841],
              [106.667591, 10.802834],
              [106.667675, 10.802812],
              [106.667756, 10.802784],
              [106.667873, 10.802715],
              [106.667928, 10.802666],
              [106.667976, 10.802614],
              [106.668041, 10.802507],
              [106.668081, 10.802367],
              [106.668102, 10.802215],
              [106.668098, 10.802144],
              [106.668123, 10.802136],
              [106.667837, 10.801218],
              [106.667813, 10.801226],
              [106.667775, 10.801165],
              [106.667673, 10.801051],
              [106.667560, 10.800958],
              [106.667505, 10.800928],
              [106.667445, 10.800904],
              [106.667377, 10.800888],
              [106.667303, 10.800878],
              [106.667237, 10.800880],
              [106.667166, 10.800886],
              [106.667084, 10.800907],
              [106.667003, 10.800936],
              [106.666885, 10.801004],
              [106.666830, 10.801053],
              [106.666781, 10.801106],
              [106.666747, 10.801159],
              [106.666717, 10.801213],
              [106.666695, 10.801280],
              [106.666675, 10.801352],
              [106.666673, 10.801481],
              [106.666490, 10.801535],
            ], "type": "LineString"
          }
        },
        {
          "type": "Feature",
          "properties": {
            "name": "Sân vận động Quân Khu 7",
            "address": "2A Đ. Phan Đình Giót, Phường 2, Tân Bình, Hồ Chí Minh",
            "type": "Stadium",
            "established": "2011",
            "area": "Khu vực thể thao, sự kiện"
          },
          "geometry": {
            "type": "Polygon",
            "symbol": {
              "type": "simple-fill",
              "color": [227, 139, 79, 0.4],
              "outline": {
                "color": [255, 255, 255],
                "width": 1
              }
            },
            "coordinates": [
              [
                106.66734446758437,
                10.801985062536913
              ],
              [
                106.6673373522766,
                10.801984719177986
              ],
              [
                106.66733030549318,
                10.801983692407932
              ],
              [
                106.66732339509853,
                10.80198199211512
              ],
              [
                106.66731668764358,
                10.801979634674309
              ],
              [
                106.66731024772483,
                10.801976642788958
              ],
              [
                106.66730413736222,
                10.801973045272579
              ],
              [
                106.66729841540193,
                10.80196887677124
              ],
              [
                106.6672931369496,
                10.80196417742991
              ],
              [
                106.66728835283956,
                10.80195899250584
              ],
              [
                106.66728410914544,
                10.801953371932704
              ],
              [
                106.6672804467363,
                10.801947369839725
              ],
              [
                106.66727740088317,
                10.801941044030352
              ],
              [
                106.66727500091916,
                10.801934455425611
              ],
              [
                106.66727326995729,
                10.801927667477377
              ],
              [
                106.66727222466757,
                10.801920745557318
              ],
              [
                106.66727187511668,
                10.801913756327313
              ],
              [
                106.66727222467092,
                10.801906767097472
              ],
              [
                106.6672732699639,
                10.801899845177893
              ],
              [
                106.66727500092875,
                10.801893057230444
              ],
              [
                106.66727740089534,
                10.801886468626753
              ],
              [
                106.66728044675065,
                10.801880142818662
              ],
              [
                106.66728410916137,
                10.801874140727147
              ],
              [
                106.66728835285646,
                10.801868520155601
              ],
              [
                106.66729313696682,
                10.801863335233184
              ],
              [
                106.66729841541886,
                10.801858635893504
              ],
              [
                106.66730413737815,
                10.80185446739375
              ],
              [
                106.66731024773914,
                10.801850869878837
              ],
              [
                106.66731668765577,
                10.80184787799477
              ],
              [
                106.6673233951081,
                10.80184552055501
              ],
              [
                106.66733030549979,
                10.801843820262981
              ],
              [
                106.66733735227997,
                10.801842793493412
              ],
              [
                106.66734446758437,
                10.801842450134645
              ],
              [
                106.66735158288878,
                10.801842793493412
              ],
              [
                106.66735862966897,
                10.801843820262981
              ],
              [
                106.66736554006066,
                10.80184552055501
              ],
              [
                106.66737224751297,
                10.80184787799477
              ],
              [
                106.66737868742959,
                10.801850869878837
              ],
              [
                106.6673847977906,
                10.80185446739375
              ],
              [
                106.6673905197499,
                10.801858635893504
              ],
              [
                106.66739579820192,
                10.801863335233184
              ],
              [
                106.66740058231227,
                10.801868520155601
              ],
              [
                106.66740482600738,
                10.801874140727147
              ],
              [
                106.6674084884181,
                10.801880142818662
              ],
              [
                106.6674115342734,
                10.801886468626753
              ],
              [
                106.66741393424,
                10.801893057230444
              ],
              [
                106.66741566520486,
                10.801899845177893
              ],
              [
                106.66741671049782,
                10.801906767097472
              ],
              [
                106.66741706005207,
                10.801913756327313
              ],
              [
                106.66741671050117,
                10.801920745557318
              ],
              [
                106.66741566521146,
                10.801927667477377
              ],
              [
                106.66741393424957,
                10.801934455425611
              ],
              [
                106.66741153428559,
                10.801941044030352
              ],
              [
                106.66740848843243,
                10.801947369839725
              ],
              [
                106.6674048260233,
                10.801953371932704
              ],
              [
                106.6674005823292,
                10.80195899250584
              ],
              [
                106.66739579821916,
                10.80196417742991
              ],
              [
                106.6673905197668,
                10.80196887677124
              ],
              [
                106.66738479780653,
                10.801973045272579
              ],
              [
                106.66737868744393,
                10.801976642788958
              ],
              [
                106.66737224752518,
                10.801979634674309
              ],
              [
                106.66736554007021,
                10.80198199211512
              ],
              [
                106.66735862967558,
                10.801983692407932
              ],
              [
                106.66735158289214,
                10.801984719177986
              ],
              [
                106.66734446758437,
                10.801985062536913
              ]
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {
            "name": "Sân vận động Thống Nhất",
            "type": "Điểm trung tâm",
            "description": "Vị trí trung tâm của khu vực SVĐ"
          },
          "geometry": {
            "type": "Point",
            "coordinates": [106.66735100638397,
              10.801907333396343]
          }
        }

      ]
    };
    require([
      "esri/Map",
      "esri/views/MapView",
      "esri/Graphic",
      "esri/layers/GraphicsLayer"
    ], function (Map, MapView, Graphic, GraphicsLayer) {

      var map = new Map({
        basemap: "topo-vector"
      });
      map.on("load", function () {
        map.graphics.enableMouseEvents();
      });

      var view = new MapView({
        container: "viewDiv",
        map: map,
        center: [106.66735100638397,
          10.801907333396343],
        zoom: 17,
        highlightOptions: {
          color: "blue"
        }
      });
      var graphicsLayer = new GraphicsLayer();

      var lineSymbol = {
        type: "simple-line",
        color: [255, 87, 34],
        width: 3,
        style: "solid"
      };

      var polygonSymbol = {
        type: "simple-fill",
        color: [33, 150, 243, 0.6],
        outline: {
          color: [21, 101, 192],
          width: 2
        }
      };

      var pointSymbol = {
        type: "picture-marker",
        url: "https://cdn-icons-png.flaticon.com/512/5540/5540420.png",
        width: "56px",
        height: "56px"
      };

      jsondata.features.forEach(function (feature) {
        var geometry;
        var symbol;
        var popupTemplate;

        if (feature.geometry.type === "LineString") {
          geometry = {
            type: "polyline",
            paths: [feature.geometry.coordinates]
          };
          symbol = lineSymbol;
          popupTemplate = {
            title: feature.properties.name,
            content: "<b>Mô tả:</b> {description}<br/><b>Loại:</b> Đường ranh giới"
          };

          var lineGraphic = new Graphic({
            geometry: geometry,
            symbol: symbol,
            attributes: feature.properties,
            popupTemplate: popupTemplate
          });
          graphicsLayer.add(lineGraphic);

          var polygonGeometry = {
            type: "polygon",
            rings: [feature.geometry.coordinates]
          };

          var polygonFill = {
            type: "simple-fill",
            color: [255, 193, 7, 0.4],
            outline: {
              color: [255, 152, 0],
              width: 2
            }
          };

          var polygonGraphic = new Graphic({
            geometry: polygonGeometry,
            symbol: polygonFill,
            attributes: { name: feature.properties.name + " (fill)" },
            popupTemplate: {
              title: feature.properties.name,
              content: "Đây là vùng được fill từ đường ranh giới."
            }
          });

          graphicsLayer.add(polygonGraphic);

          return;
        } else if (feature.geometry.type === "Polygon") {
          geometry = {
            type: "polygon",
            rings: feature.geometry.coordinates
          };
          symbol = polygonSymbol;
          popupTemplate = {
            title: feature.properties.name,
            content: `
              <div style="font-family: Arial, sans-serif;">
                <p><b>📍 Địa chỉ:</b> {address}</p>
                <p><b>🏛️ Loại:</b> {type}</p>
                <p><b>📅 Thành lập:</b> {established}</p>
                <p><b>🗺️ Khu vực:</b> {area}</p>
                <p><b>ℹ️ Mô tả:</b> Trụ sở chính của chính quyền thành phố</p>
              </div>
            `
          };
        } else if (feature.geometry.type === "Point") {
          geometry = {
            type: "point",
            longitude: feature.geometry.coordinates[0],
            latitude: feature.geometry.coordinates[1]
          };
          symbol = pointSymbol;
          popupTemplate = {
            title: feature.properties.name,
            content: `
              <div style="font-family: Arial, sans-serif; text-align: center;">
                <p><b>📍 {type}</b></p>
                <p>{description}</p>
                <p style="color: #1976D2;"><b>Tọa độ:</b><br/>
                Kinh độ: ${feature.geometry.coordinates[0].toFixed(6)}<br/>
                Vĩ độ: ${feature.geometry.coordinates[1].toFixed(6)}</p>
              </div>
            `
          };
        }

        var graphic = new Graphic({
          geometry: geometry,
          symbol: symbol,
          attributes: feature.properties,
          popupTemplate: popupTemplate
        });
        graphicsLayer.add(graphic);
      });

      map.add(graphicsLayer);


    });
  </script>
</head>

<body>
  <div id="viewDiv"></div>
</body>

</html>
